(function(){"use strict";angular.module("earshotApp",["ngCookies","ngResource","ngSanitize","ngRoute"]).config(["$routeProvider","$locationProvider",function(a,b){return a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"}),b.html5Mode(!0)}])}).call(this),function(){"use strict";angular.module("earshotApp").controller("MainCtrl",["$scope",function(){return mixpanel.track("Landing page loaded"),mixpanel.track_links("#downloadLink","Download Link Clicked")}])}.call(this),function(){"use strict";var a=function(a,b){return function(){return a.apply(b,arguments)}};angular.module("earshotApp").directive("peeps",["$window",function(b){return{template:'<svg id="svg" ng-style="style"></svg>',restrict:"E",scope:{person:"@"},link:function(c,d){var e,f,g,h,i,j,k;return c.peeps={},j=function(){var a;return a=angular.element(b),c.style={height:a.height()/2},console.log("Height is "+c.style.height),c.numPeeps=Math.floor(Math.min(a.height(),a.width())/80),console.log("Creating "+c.numPeeps+" peeps")},i=function(){var a,b;return b=d[0].children[0],c.s=a=Snap(b)},h=function(){var a,b,f,h,i;for(console.dir(d[0].children[0].clientHeight),i=[],a=f=0,h=c.numPeeps;h>=0?h>f:f>h;a=h>=0?++f:--f)b=g(!0),i.push(c.peeps[a]=new e(b,c.s));return i},g=function(a){var b,e,g,h,i,j,k,l,m,n;for(null==a&&(a=!1),i=0,m=0,h=20;150>i;){m++,console.log("offset!"),l={x:Math.random()*(d[0].children[0].clientWidth-100),y:Math.random()*(c.style.height-100)},k=999999,n=c.peeps;for(g in n)j=n[g],e=a?j.pos:j.g.getBBox(),b=f(l,e),k>b&&(k=b);if(i=k,m>h)break}return l},f=function(a,b){return Math.abs(b.x-a.x)+Math.abs(b.y-a.y)},k=function(){var a,b,d,e,f;e=c.peeps,f=[];for(a in e)b=e[a],d=500*Math.random()+2e3,f.push(b.show(d));return f},e=function(){function b(b,d){var e=this;this.pos=b,this.s=d,this.sendMessages=a(this.sendMessages,this),this.tryWalk=a(this.tryWalk,this),console.log("Created new person at position "+b.x+", "+b.y),Snap.load(c.person,function(a){var b;return b=a.selectAll(),e.g=a.select("g"),e.g.attr({transform:"t"+e.pos.x+","+e.pos.y+"s0,0",opacity:1}),e.g.selectAll("path").attr({fill:"#FFFFFF"}),e.g.selectAll("circle").attr({fill:"#FFFFFF"}),e.s.append(e.g),console.log(e.g.getBBox().x),console.log(e.pos.x)})}return b.prototype.show=function(a){var b=this;return console.log("showing peep!"),setTimeout(function(){return b.g.animate({transform:"t"+b.pos.x+","+b.pos.y+"s0.3,0.3",opacity:1},400,mina.elastic,function(){return b.startSendingMessages()})},a)},b.prototype.startSendingMessages=function(){var a,b,c=this;return b=2e3*Math.random(),a=5e3*Math.random()+2e3,setTimeout(function(){return setInterval(c.sendMessages,a)},b)},b.prototype.drift=function(){var a,b=this;return a={x:50*Math.random()-25,y:50*Math.random()-25},this.g.animate({transform:"t"+(this.pos.x+a.x)+","+(this.pos.y+a.y)+"s0.3,0.3"},5e3,function(){return b.drift()})},b.prototype.tryWalk=function(){return!this.walking&&Math.random()>.8?this.walk():void 0},b.prototype.walk=function(){var a,b,c,d,e=this;for(this.walking=!0,a=1e3,d=0,b=10;a>300&&(d++,c=g(),a=f(c,this.g.getBBox()),!(d>b)););return this.pos=c,this.g.animate({transform:"t"+this.pos.x+","+this.pos.y+"s0.3,0.3"},1e3,mina.easeinout,function(){return e.walking=!1})},b.prototype.sendMessages=function(){var a,b,d,e,g;g=c.peeps;for(b in g)e=g[b],a=f(this.g.getBBox(),e.g.getBBox()),500>a&&(d=this.s.line(this.g.getBBox().x+15,this.g.getBBox().y+15,e.g.getBBox().x+15,e.g.getBBox().y+15),d.attr({stroke:"#FFFFFF",strokeWidth:1,opacity:.3}),d.animate({opacity:0},300,function(){return this.remove()}));return setTimeout(this.tryWalk,1e3)},b}(),j(),i(),h(),k()}}}])}.call(this);